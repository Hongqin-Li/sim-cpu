{"version":3,"sources":["pipe.js","layout.js","index.js"],"names":["F_stall","F_bubble","D_stat","D_icode","D_ifun","D_rA","D_rB","D_valC","D_valP","D_stall","D_bubble","E_stat","E_icode","E_ifun","E_dstE","E_dstM","E_srcA","E_srcB","E_valA","E_valB","E_valC","E_stall","E_bubble","M_stat","M_icode","M_Cnd","M_dstE","M_dstM","M_valA","M_valE","M_bubble","W_stat","W_icode","W_dstE","W_dstM","W_valM","W_valE","W_stall","W_bubble","f_predPC","f_stat","f_icode","f_ifun","f_rA","f_rB","f_valC","f_valP","d_stat","d_icode","d_ifun","d_valA","d_valB","d_valC","d_dstE","d_dstM","d_srcA","d_srcB","e_stat","e_icode","e_Cnd","e_dstE","e_dstM","e_valA","e_valE","m_stat","m_icode","m_dstE","m_dstM","m_valM","m_valE","imem_error","dmem_error","stats","icodes","regs","breakpoints","Set","Pipe","Object","classCallCheck","this","Memory","createClass","key","value","rtn","length","i","valToHex","registerFile","registers","init","clear","str","code","isValid","hex_addr","addr","parseInt","isNaN","j","setCode","add","delete","has","stepi","time","setTimeout","func","Stat","SINS","SADR","SHLT","console","log","F_predPC","val","readMemory","arguments","undefined","pair","MAX_MEM","x","toString","push","slice","cache","Cache","t","s","l","set","k","tag","valid","kk","block","newCache","nextLevel","reset","splice","S","b","B","L2","ad","Math","random","read","write","RegisterFile","A","VALZERO","M","E","srcA","srcB","dstM","dstE","RNONE","IHALT","INOP","IRRMOVQ","IIRMOVQ","IRMMOVQ","IMRMOVQ","IOPQ","IJXX","ICALL","IRET","IPUSHQ","IPOPQ","RRSP","ALUADD","SAOK","SBUB","ZF","SF","OF","alu_cc","set_cc","CC","intToVal","temp","addq","valA","valB","carry","int_sum","str_s","xorq","bytes","opt","ops","a","ifun","andq","rtn_sign","a_sign","b_sign","doFetch","instr_valid","need_regids","need_valC","stat","pc","predPC","valC","valP","split","align","icode","rA","rB","check_f_instr_valid","check_f_need_regids","check_f_need_valC","check_f_stat","doDecode","rvalA","rvalB","check_d_dstE","check_d_dstM","check_d_srcA","check_d_srcB","d_rvalA","check_d_valA","d_rvalB","check_d_valB","doExecute","cond","alufun","aluA","aluB","valE","check_e_aluA","check_e_aluB","check_e_cond","doMemory","mem_read","mem_write","data_in","valM","check_m_mem_addr","len","writeMemory","resetW","resetM","resetE","resetD","resetF","steps","step","load_use_hazard","doControlLogic","stageColor","red","purple","orange","green","blue","runTimeout","speedOpt","colorDel","pipe","breakPoints","theme","createMuiTheme","palette","primary","brown","background","default","grey","typography","useNextVariants","fontSize","fontFamily","join","StageCards","state","grow","stageRegisters","_this","props","onRefresh","in","y","position","ref","index","rect","getBoundingClientRect","randX","randY","window","innerWidth","width","innerHeight","height","newPos","setState","changePosition","_this2","timeout","delay","classes","map","name","react_default","createElement","style","zIndex","left","top","Fragment","Grow_default","unmountOnExit","hide","onEnter","newGrow","onEntered","onExit","onExited","Card_default","CardActionArea_default","backgroundColor","CardHeader_default","avatar","Avatar_default","title","CardContent_default","prop","Typography_default","component","React","Component","CodeLayout","parent","getStageRegisters","Paper_default","padding","spacing","unit","overflow","line","address","onContextMenu","onDoubleClick","event","nameMap","target","attributes","isbreakpoint","deleteBreakpoint","toast","fontWeight","addBreakpoint","onMouseEnter","onMouseOut","StageRegistersLayout","_this3","stageStuffs","anchorEl","popText","_this4","List_default","className","list","ListSubheader_default","subHeader","Popover_default","id","open","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","margin","ListItem_default","button","onClick","currentTarget","ListItemText_default","RegisterFileLayout","r","getRegisterFile","Table_default","table","TableHead_default","TableRow_default","row","TableCell_default","textAlign","flexGrow","TableBody_default","CacheLayout","_this6","expanded","ini","_this7","h","w","cac","react_draggable_default","ExpansionPanel_default","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","e","exp","ExpansionPanelDetails_default","dense","maxHeight","si","li","addrBegin","addrEnd","getValueFromMemory","Tooltip_default","newOpen","noWrap","MenuLayout","settingExpanded","openMemory","openCache","openAbout","memory","speedMenuOpen","speedIndex","Slide_default","assign","direction","_this9","mainLayout","ListItemIcon_default","Settings_default","Collapse_default","disablePadding","inset","Menu_default","option","MenuItem_default","selected","getMemory","Reorder_default","getCache","FilterList_default","transform","Divider_default","Info_default","Dialog_default","scroll","keepMounted","TransitionComponent","Transition","DialogTitle_default","DialogContent_default","DialogContentText_default","Button_default","textTransform","IconButton_default","removeCache","initCache","refreshCache","Delete_default","DialogActions_default","addCache","color","MainLayout","_this10","possibleConstructorReturn","getPrototypeOf","call","handleUpload","bind","assertThisInitialized","colorDeg","colorL","colorR","textHeight","cardsHide","cardsHalt","fabIn","onFabTransit","fabTooltipOpen","run","drawerOpen","onStageAnimation","stageIn","refreshStage","messageQueue","snackbarOpen","cacheIn","oldCache","getStageStuffs","textFieldDiv","createRef","msg","msgQueue","fileReader","FileReader","onload","result","codeLines","files","readAsText","f","_this11","newIn","_this12","flag","stepPipe","PC","getPC","refreshStageRegisters","_this13","root","CssBaseline_default","core_styles","Drawer_default","layout_MenuLayout","tabIndex","role","onKeyDown","AppBar_default","appBar","display","alignContent","Toolbar_default","aria-label","icons_Menu_default","enterDelay","leaveDelay","fileUpload","click","Add_default","type","accept","visibility","onInput","variant","right","layout_CacheLayout","Snackbar_default","autoHideDuration","shift","ContentProps","aria-describedby","message","content","layout_StageCards","alignItems","marginBottom","marginRight","layout_CodeLayout","layout_StageRegistersLayout","defaultExpanded","details","layout_RegisterFileLayout","bottom","layout_TriTooltip","Zoom_default","runPipe","Fab_default","Pause_default","ChevronRight_default","TriTooltip","cnt","_React$createElement","_this15","onOpen","defineProperty","children","withStyles","toolbar","justifyContent","drawer","flexShrink","paddingTop","paper","overflowX","textField","rows","rowsMax","panel","paddingLeft","text","paddingRight","rootElement","document","getElementById","ReactDOM","render","layout"],"mappings":"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","file":"static/js/main.e25a31dd.chunk.js","sourcesContent":["const stats = [\"\", \"SAOK\", \"SADR\", \"SINS\", \"SHLT\", \"SBUB\"];\nconst icodes = [\n  \"HALT\",\n  \"NOP\",\n  \"RRMOVQ\",\n  \"IRMOVQ\",\n  \"RMMOVQ\",\n  \"MRMOVQ\",\n  \"OPQ\",\n  \"JXX\",\n  \"CALL\",\n  \"RET\",\n  \"PUSHQ\",\n  \"IPOPQ\"\n];\nconst regs = [\n  \"rax\",\n  \"rcx\",\n  \"rdx\",\n  \"rbx\",\n  \"rsp\",\n  \"rbp\",\n  \"rsi\",\n  \"rdi\",\n  \"r8\",\n  \"r9\",\n  \"r10\",\n  \"r11\",\n  \"r12\",\n  \"r13\",\n  \"r14\",\n  \"\"\n];\n\nlet breakpoints = new Set();\n\nexport class Pipe {\n  constructor() {\n    this.Memory = Memory;\n  }\n  getRegisterFile() {\n    let rtn = [\"\"];\n    rtn.length = 16;\n    for (let i = 0; i < 16; i++) {\n      rtn[i] = valToHex(registerFile.registers[i]);\n    }\n    return rtn;\n  }\n  init() {\n    init();\n    breakpoints.clear();\n  }\n  setCode(str) {\n    init();\n    setCode(str);\n    //init();\n  }\n  addBreakpoint(str) {\n    breakpoints.add(str);\n  }\n  deleteBreakpoint(str) {\n    breakpoints.delete(str);\n  }\n  hasBreakpoint(str) {\n    return breakpoints.has(str);\n  }\n\n  stepi(i) {\n    return stepi(i);\n  }\n  run(time) {\n    setTimeout(function func() {\n      if (!(Stat == SINS || Stat == SADR || Stat == SHLT)) {\n        stepi(1);\n        console.log(\"step\");\n        setTimeout(func, time);\n      }\n    }, time);\n  }\n  getPC() {\n    return valToHex(F_predPC);\n  }\n  getStat() {\n    return Stat;\n  }\n  getValueFromMemory(addr, byte = 8) {\n    let val = readMemory(addr, byte, 1);\n    let rtn = \"\";\n    for (let i = 0; i < val.length; i++) {\n      rtn += val[i];\n    }\n    return rtn;\n  }\n  //return [ [addr, hex_val ],...]\n  getMemory() {\n    let rtn = [];\n    let pair = [\"addr\", \"hex_val\"];\n    for (let i = ((MAX_MEM - 8) >> 3) << 3; i >= 0; i -= 8) {\n      let x = valToHex(readMemory(i, 8, 1));\n      //let x = valToHex(Memory[i]);\n\n      if (x != \"0\") {\n        let j = i >> 3;\n        pair[0] = i.toString(16);\n        pair[1] = x;\n        rtn.push(pair.slice());\n      }\n    }\n    return rtn;\n  }\n\n  getCache() {\n    let rtn = [];\n    rtn.length = cache.length;\n    for (let i = 0; i < cache.length; i++) {\n      rtn[i] = new Cache(cache[i].t, cache[i].s, cache[i].l);\n      for (let j = 0; j < cache[i].set.length; j++) {\n        for (let k = 0; k < cache[i].set[j].length; k++) {\n          rtn[i].set[j][k].tag = cache[i].set[j][k].tag;\n          rtn[i].set[j][k].valid = cache[i].set[j][k].valid;\n          for (let kk = 0; kk < cache[i].set[j][k].block.length; kk++) {\n            rtn[i].set[j][k].block[kk] = cache[i].set[j][k].block[kk];\n          }\n        }\n      }\n    }\n    return rtn;\n    //return cache.slice();\n  }\n  addCache(t = 60, s = 2, l = 1) {\n    let newCache = new Cache(t, s, l);\n    if (cache.length - 1 >= 0) cache[cache.length - 1].nextLevel = newCache;\n    cache.push(newCache);\n    for (let i = 0; i < cache.length; i++) {\n      cache[i].reset();\n    }\n  }\n  removeCache(i = cache.length - 1) {\n    cache[i] = null;\n    cache.splice(i, 1);\n    if (i - 1 >= 0) cache[i - 1].nextLevel = i < cache.length ? cache[i] : null;\n    for (let i = 0; i < cache.length; i++) {\n      cache[i].reset();\n    }\n  }\n\n  getStageStuffs() {\n    return [\n      [\n        [\"m_stat\", stats[m_stat]],\n        [\"m_icode\", icodes[m_icode]],\n        [\"m_valE\", valToHex(m_valE)],\n        [\"m_valM\", valToHex(m_valM)],\n        [\"m_dstE\", regs[m_dstE]],\n        [\"m_dstM\", regs[m_dstM]]\n      ],\n      [\n        [\"e_stat\", stats[e_stat]],\n        [\"e_icodes\", icodes[e_icode]],\n        [\"e_Cnd\", e_Cnd ? \"Y\" : \"N\"],\n        [\"e_valE\", valToHex(e_valE)],\n        [\"e_valA\", valToHex(e_valA)],\n        [\"e_dstE\", regs[e_dstE]],\n        [\"e_dstM\", regs[e_dstM]]\n      ],\n      [\n        [\"d_stat\", stats[d_stat]],\n        [\"d_icode\", icodes[d_icode]],\n        [\"d_ifun\", \"\" + d_ifun],\n        [\"d_valC\", valToHex(d_valC)],\n        [\"d_valA\", valToHex(d_valA)],\n        [\"d_valB\", valToHex(d_valB)],\n        [\"d_dstE\", regs[d_dstE]],\n        [\"d_dstM\", regs[d_dstM]],\n        [\"d_srcA\", regs[d_srcA]],\n        [\"d_srcB\", regs[d_srcB]]\n      ],\n      [\n        [\"f_stat\", stats[f_stat]],\n        [\"f_icode\", icodes[f_icode]],\n        [\"f_ifun\", \"\" + f_ifun],\n        [\"f_rA\", regs[f_rA]],\n        [\"f_rB\", regs[f_rB]],\n        [\"f_valC\", valToHex(f_valC)],\n        [\"f_valP\", valToHex(f_valP)]\n      ],\n      [[\"predPC\", valToHex(F_predPC)]]\n    ];\n  }\n\n  getStageRegisters() {\n    return [\n      [\n        [\"stat\", stats[W_stat]],\n        [\"icode\", icodes[W_icode]],\n        [\"valE\", valToHex(W_valE)],\n        [\"valM\", valToHex(W_valM)],\n        [\"dstE\", regs[W_dstE]],\n        [\"dstM\", regs[W_dstM]]\n      ],\n      [\n        [\"stat\", stats[M_stat]],\n        [\"icodes\", icodes[M_icode]],\n        [\"Cnd\", M_Cnd ? \"Y\" : \"N\"],\n        [\"valE\", valToHex(M_valE)],\n        [\"valA\", valToHex(M_valA)],\n        [\"dstE\", regs[M_dstE]],\n        [\"dstM\", regs[M_dstM]]\n      ],\n      [\n        [\"stat\", stats[E_stat]],\n        [\"icode\", icodes[E_icode]],\n        [\"ifun\", \"\" + E_ifun],\n        [\"valC\", valToHex(E_valC)],\n        [\"valA\", valToHex(E_valA)],\n        [\"valB\", valToHex(E_valB)],\n        [\"dstE\", regs[E_dstE]],\n        [\"dstM\", regs[E_dstM]],\n        [\"srcA\", regs[E_srcA]],\n        [\"srcB\", regs[E_srcB]]\n      ],\n      [\n        [\"stat\", stats[D_stat]],\n        [\"icode\", icodes[D_icode]],\n        [\"ifun\", \"\" + D_ifun],\n        [\"rA\", regs[D_rA]],\n        [\"rB\", regs[D_rB]],\n        [\"valC\", valToHex(D_valC)],\n        [\"valP\", valToHex(D_valP)]\n      ],\n      [[\"predPC\", valToHex(F_predPC)]]\n    ];\n  }\n}\n//Guarantee that addr is int32 and s, b is small enough\nclass Cache {\n  //l = 1 direact map\n  constructor(t = 60, s = 2, l = 1) {\n    //initialization\n    this.nextLevel = null;\n    this.s = s;\n    this.S = 1 << s;\n    this.t = t;\n    this.b = 64 - t - s;\n    this.B = 1 << this.b;\n    this.l = l;\n    this.set = [];\n    this.set.length = this.S;\n    for (let i = 0; i < this.set.length; i++) {\n      this.set[i] = [];\n      this.set[i].length = l;\n      for (let j = 0; j < l; j++) {\n        this.set[i][j] = {};\n        this.set[i][j].valid = false;\n        this.set[i][j].block = [\"\"];\n        this.set[i][j].block.length = this.B;\n      }\n    }\n  }\n  reset() {\n    for (let i = 0; i < this.set.length; i++)\n      for (let j = 0; j < this.set[i].length; j++) this.set[i][j].valid = false;\n  }\n  setNextLevel(L2) {\n    this.nextLevel = L2;\n  }\n  read(addr) {\n    //s + b should be small\n    let t = addr >> (this.s + this.b);\n    let s = (addr - (t << (this.s + this.b))) >> this.b;\n    let b = addr - (t << (this.s + this.b)) - (s << this.b);\n    for (let i = 0; i < this.set[s].length; i++) {\n      if (this.set[s][i].tag == t && this.set[s][i].valid == true) {\n        //Hit\n        console.log(\"hit\");\n        return this.set[s][i].block[b];\n      }\n    }\n    //Miss\n    console.log(\"miss\");\n    //Address of the first block, erase the least significant bits\n    let ad = (addr >> this.b) << this.b;\n    //Random replacement policy: Randomly choose a line to replace\n    let i = parseInt(Math.random() * this.set[s].length, 10);\n    this.set[s][i].valid = true;\n    this.set[s][i].tag = t;\n    //The bottom of Cache Hierarchy is Memory\n    if (!this.nextLevel)\n      for (let j = 0; j < this.B; j++) this.set[s][i].block[j] = Memory[ad + j];\n    else\n      for (let j = 0; j < this.B; j++)\n        this.set[s][i].block[j] = this.nextLevel.read(ad + j);\n    return this.set[s][i].block[b];\n  }\n  //Write-Through, almost the same\n  write(addr, val) {\n    let t = addr >> (this.s + this.b);\n    let s = (addr - (t << (this.s + this.b))) >> this.b;\n    let b = addr - (t << (this.s + this.b)) - (s << this.b);\n    for (let i = 0; i < this.set[s].length; i++) {\n      if (this.set[s][i].tag == t && this.set[s][i].valid == true) {\n        //hit\n        console.log(\"hit\");\n        this.set[s][i].block[b] = val;\n        break;\n      }\n    }\n    //No-write-allocate: When encountering a write miss, bypasses the cache and write directly to the next lower level\n    if (!this.nextLevel) Memory[addr] = val;\n    else this.nextLevel.write(addr, val);\n  }\n}\n\n/* Classes */\nclass RegisterFile {\n  constructor() {\n    this.A = VALZERO.slice();\n    this.B = VALZERO.slice();\n    this.M = VALZERO.slice();\n    this.E = VALZERO.slice();\n    /*this.B = [\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\"];\n    this.M = [\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\"];\n    this.E = [\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\",\"00\"];\n    */\n    this.srcA = this.srcB = this.dstM = this.dstE = RNONE;\n    this.registers = [VALZERO.slice()];\n    this.registers.length = 16;\n    for (let i = 0; i < 16; i++) this.registers[i] = this.A;\n    console.log(this.registers);\n  }\n  reset() {\n    this.A = VALZERO.slice();\n    this.B = VALZERO.slice();\n    this.M = VALZERO.slice();\n    this.E = VALZERO.slice();\n    for (let i = 0; i < 16; i++) this.registers[i] = VALZERO.slice();\n    this.srcA = this.srcB = this.dstM = this.dstE = RNONE;\n  }\n  read() {\n    this.A = this.registers[this.srcA].slice();\n    this.B = this.registers[this.srcB].slice();\n  }\n  write() {\n    //!caution, if dstE == dstM(!=RNONE)(e.g. pop %rsp), only to write dstM\n\n    this.registers[this.dstE] = this.E.slice();\n    this.registers[this.dstM] = this.M.slice();\n  }\n}\n\n/* Classes end */\n\nconst MAX_MEM = 800;\n\nconst IHALT = 0,\n  INOP = 1,\n  IRRMOVQ = 2,\n  IIRMOVQ = 3,\n  IRMMOVQ = 4,\n  IMRMOVQ = 5,\n  IOPQ = 6,\n  IJXX = 7,\n  ICALL = 8,\n  IRET = 9,\n  IPUSHQ = 10,\n  IPOPQ = 11;\nconst FNONE = 0;\nconst RNONE = 15,\n  RRSP = 4;\nconst ALUADD = 0;\nconst SAOK = 1,\n  SADR = 2,\n  SINS = 3,\n  SHLT = 4,\n  SBUB = 5;\nconst ZF = 4,\n  SF = 2,\n  OF = 1;\n\nconst VALZERO = [\"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\"];\n\n/**  Stage Registers **/\nlet F_predPC = VALZERO.slice(),\n  F_stall,\n  F_bubble;\nlet D_stat, D_icode, D_ifun, D_rA, D_rB, D_valC, D_valP, D_stall, D_bubble;\nlet E_stat,\n  E_icode,\n  E_ifun,\n  E_dstE,\n  E_dstM,\n  E_srcA,\n  E_srcB,\n  E_valA,\n  E_valB,\n  E_valC,\n  E_stall,\n  E_bubble;\nlet M_stat, M_icode, M_Cnd, M_dstE, M_dstM, M_valA, M_valE, M_stall, M_bubble;\nlet W_stat, W_icode, W_dstE, W_dstM, W_valM, W_valE, W_stall, W_bubble;\n\n/** Stage outputs **/\nlet f_predPC,\n  f_stat,\n  f_icode,\n  f_ifun,\n  f_rA,\n  f_rB,\n  f_valC,\n  f_valP,\n  f_stall,\n  f_bubble;\nlet d_stat,\n  d_icode,\n  d_ifun,\n  d_valA,\n  d_valB,\n  d_valC,\n  d_dstE,\n  d_dstM,\n  d_srcA,\n  d_srcB,\n  d_stall,\n  d_bubble;\nlet e_stat, e_icode, e_Cnd, e_dstE, e_dstM, e_valA, e_valE, e_stall, e_bubble;\nlet m_stat, m_icode, m_dstE, m_dstM, m_valM, m_valE, m_stall, m_bubble;\n\nlet imem_error, dmem_error;\nlet Memory = [\"0\"];\nMemory.length = MAX_MEM;\n\n/*\n\nlet L1Cache = new Cache();\nlet L2Cache = new Cache();\n\nL1Cache.setNextLevel(L2Cache);\n*/\nlet cache = [];\n\n//cache.push(L1Cache);\n//cache.push(L2Cache);\n\nlet registerFile = new RegisterFile();\n\nlet alu_cc;\nlet set_cc;\nlet CC;\nlet Stat;\n\n//everything named val is stored by string array ,each byte\n\n//should be positive;\nfunction intToVal(x) {\n  let rtn = VALZERO.slice();\n  rtn.length = 8;\n  for (let i = 0; i < 8; i++) {\n    let temp = x & 0xff;\n    rtn[i] = temp.toString(16);\n    if (rtn[i].length == 1) rtn[i] = \"0\" + rtn[i];\n    x >>= 8;\n  }\n  return rtn;\n}\n/* return string */\nfunction valToHex(val) {\n  if (val == undefined) return \"0\";\n  let rtn = \"\";\n  let zero_front = true;\n  let i = 7;\n\n  while (i >= 0 && parseInt(val[i], 16) == 0) {\n    i--;\n  }\n  if (i < 0) return \"0\";\n  if (val[i][0] != \"0\") rtn += val[i][0];\n  rtn += val[i][1];\n  for (let j = i - 1; j >= 0; j--) {\n    rtn += val[j][0] + val[j][1];\n  }\n  return rtn;\n}\n//return a val\nfunction addq(valA, valB) {\n  let rtn = VALZERO.slice();\n  rtn.length = 8;\n  let carry = 0;\n  for (let i = 0; i < 8; i++) {\n    let int_sum = parseInt(valA[i], 16) + parseInt(valB[i], 16) + carry;\n    carry = int_sum >> 8;\n    let s = int_sum & 0xff;\n    let str_s = s.toString(16);\n    if (str_s.length == 1) rtn[i] = \"0\" + str_s;\n    else rtn[i] = str_s;\n  }\n  //overflow\n  //if (carry) console.log(\"overflow\");\n\n  return rtn;\n}\nfunction subq(valA, valB) {\n  let rtn = VALZERO.slice();\n  let notB = xorq(valB, [\"ff\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\"]);\n  return addq(\n    valA,\n    addq(notB, [\"01\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\"])\n  );\n}\nfunction andq(valA, valB) {\n  let rtn = VALZERO.slice();\n  rtn.length = 8;\n  for (let i = 0; i < 8; i++) {\n    let s = parseInt(valA[i], 16) & parseInt(valB[i], 16) & 0xff;\n    rtn[i] = s.toString(16);\n    if (rtn[i].length == 1) rtn[i] = \"0\" + rtn[i];\n  }\n  return rtn;\n}\nfunction xorq(valA, valB) {\n  let rtn = VALZERO.slice();\n  rtn.length = 8;\n  for (let i = 0; i < 8; i++) {\n    let s = (parseInt(valA[i], 16) ^ parseInt(valB[i], 16)) & 0xff;\n    rtn[i] = s.toString(16);\n    if (rtn[i].length == 1) rtn[i] = \"0\" + rtn[i];\n  }\n  return rtn;\n}\n\n/* read eight bytes from memory, return null when error*/\n/* return rtn = [\"00\", \"02\", ...] */\n/* opt = 0, read from cache, opt = 1, read directly from memory*/\nfunction readMemory(addr, bytes = 8, opt = 0) {\n  if (addr + bytes > MAX_MEM || addr < 0) {\n    return null;\n  }\n  let rtn = VALZERO.slice();\n  rtn.length = bytes;\n  for (let i = 0; i < bytes; i++) {\n    rtn[i] =\n      opt == 0 && cache.length > 0 ? cache[0].read(addr + i) : Memory[addr + i]; //read cache\n    //rtn[i] = Memory[addr + i];\n    if (rtn[i] == undefined) rtn[i] = \"00\";\n  }\n  return rtn;\n}\n/* write val into memory e.g. val = [\"00\", \"01\"]*/\nfunction writeMemory(addr, val) {\n  let len = val.length;\n  if (addr + len > MAX_MEM || addr < 0) return null;\n  for (let i = 0; i < len; i++) {\n    if (cache.length > 0) cache[0].write(addr + i, val[i]);\n    else Memory[addr + i] = val[i];\n  }\n  return true;\n}\n\nfunction setCode(code) {\n  let isValid = true;\n  for (let i = 0; i < code.length; i++) {\n    if (code[i] == \"\\n\") {\n      isValid = true;\n      continue;\n    }\n    if (\n      isValid &&\n      i + 2 < code.length &&\n      code[i] == \"0\" &&\n      code[i + 1] == \"x\"\n    ) {\n      isValid = false;\n\n      let hex_addr = \"\";\n      let addr;\n      i++;\n      //console.log(\"find it\" + code[i + 2] + code[i + 3] + code[i + 4]);\n      while (code[++i] == \"0\") {}\n      while (code[i] != \":\") hex_addr += code[i++];\n      addr = parseInt(hex_addr, 16);\n      if (isNaN(addr)) {\n        addr = 0;\n      }\n      i += 2;\n      let j;\n      for (j = 0; i + j < code.length && code[i + j] != \" \"; j = j + 2) {\n        Memory[addr + (j >> 1)] = code[i + j];\n        Memory[addr + (j >> 1)] += code[i + j + 1];\n      }\n      i += j - 1;\n    } else isValid = false;\n  }\n}\n\nfunction ops(a, b, ifun) {\n  let rtn;\n  switch (ifun) {\n    case 0:\n      rtn = addq(a, b);\n      break;\n    case 1:\n      rtn = subq(a, b);\n      break;\n    case 2:\n      rtn = andq(a, b);\n      break;\n    case 3:\n      rtn = xorq(a, b);\n      break;\n    default:\n      rtn = null;\n      break;\n  }\n  let rtn_sign = parseInt(rtn[7], 16) >> 7;\n  let a_sign = parseInt(a[7], 16) >> 7;\n  let b_sign = parseInt(b[7], 16) >> 7;\n  alu_cc = 0;\n  if (parseInt(valToHex(rtn), 16) == 0) alu_cc |= ZF;\n  if (rtn_sign == 1) alu_cc |= SF;\n  if (a_sign == b_sign && rtn_sign != a_sign) alu_cc |= OF;\n\n  return rtn;\n}\n\n/* long long */\nfunction check_f_pc() {\n  //!Mispredicted branch. Fetch at incremented PC\n  if (M_icode == IJXX && !M_Cnd) return M_valA;\n  //!Completion of RET instruction\n  else if (W_icode == IRET) return W_valM;\n  //!Default: Use predicted P\n  else return F_predPC;\n}\n// return bool\nfunction check_f_instr_valid(icode, ifun) {\n  switch (icode) {\n    case IJXX:\n    case IRRMOVQ:\n      return ifun < 7;\n    case IOPQ:\n      return ifun < 4;\n    default:\n      return ifun < 1;\n  }\n}\n//return bool\nfunction check_f_need_regids(icode) {\n  switch (icode) {\n    case IHALT:\n    case INOP:\n    case IJXX:\n    case ICALL:\n    case IRET:\n      return false;\n    default:\n      return true;\n  }\n}\n//return bool\nfunction check_f_need_valC(icode) {\n  switch (icode) {\n    case IIRMOVQ:\n    case IRMMOVQ:\n    case IMRMOVQ:\n    case IJXX:\n    case ICALL:\n      return true;\n    default:\n      return false;\n  }\n}\n//return int\nfunction check_f_stat(imem_error, instr_valid, icode) {\n  if (imem_error == true) return SADR;\n  else if (!instr_valid == true) return SINS;\n  else if (icode == IHALT) return SHLT;\n  else return SAOK;\n}\n//return int\nfunction check_d_srcA() {\n  switch (D_icode) {\n    case IRRMOVQ:\n    case IRMMOVQ:\n    case IOPQ:\n    case IPUSHQ:\n      return D_rA;\n    case IPOPQ:\n    case IRET:\n      return RRSP;\n    default:\n      return RNONE;\n  }\n}\n\n//return  int\nfunction check_d_srcB() {\n  switch (D_icode) {\n    case IMRMOVQ:\n    case IRMMOVQ:\n    case IOPQ:\n      return D_rB;\n\n    case IPUSHQ:\n    case IPOPQ:\n    case ICALL:\n    case IRET:\n      return RRSP;\n    default:\n      return RNONE;\n  }\n}\n//return int\nfunction check_d_dstM() {\n  switch (D_icode) {\n    case IMRMOVQ:\n    case IPOPQ:\n      return D_rA;\n    default:\n      return RNONE;\n  }\n}\n//return int\nfunction check_d_dstE() {\n  switch (D_icode) {\n    case IRRMOVQ: //condition move\n    case IIRMOVQ:\n    case IOPQ:\n      return D_rB;\n    case IPUSHQ:\n    case IPOPQ:\n    case ICALL:\n    case IRET:\n      return RRSP;\n    default:\n      return RNONE;\n  }\n}\n//return long long(long long d_rvalA)\nfunction check_d_valA(d_srcA, d_rvalA) {\n  if (D_icode == ICALL || D_icode == IJXX) {\n    return D_valP;\n  } else if (d_srcA == e_dstE) {\n    return e_valE;\n  } else if (d_srcA == M_dstM) {\n    return m_valM;\n  } else if (d_srcA == M_dstE) {\n    return M_valE;\n  } else if (d_srcA == W_dstM) {\n    return W_valM;\n  } else if (d_srcA == W_dstE) {\n    return W_valE;\n  } else return d_rvalA;\n}\n\n//return long long(long long d_rvalB)\nfunction check_d_valB(d_srcB, d_rvalB) {\n  if (d_srcB == e_dstE) {\n    return e_valE;\n  } else if (d_srcB == M_dstM) {\n    return m_valM;\n  } else if (d_srcB == M_dstE) {\n    return M_valE;\n  } else if (d_srcB == W_dstM) {\n    return W_valM;\n  } else if (d_srcB == W_dstE) {\n    return W_valE;\n  } else return d_rvalB;\n}\n\n//long long: return, valA, valC\nfunction check_e_aluA(icode, valA, valC) {\n  switch (icode) {\n    case IRRMOVQ:\n    case IOPQ:\n      return valA;\n\n    case IIRMOVQ:\n    case IRMMOVQ:\n    case IMRMOVQ:\n      return valC;\n\n    case ICALL:\n    case IPUSHQ:\n      return [\"f8\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\", \"ff\"];\n    //subq(VALZERO.slice());\n\n    case IRET:\n    case IPOPQ:\n      return [\"08\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\", \"00\"];\n    //other operation don't need aluB\n    default:\n      return VALZERO;\n  }\n}\n//long long: return, valB, valC\nfunction check_e_aluB(icode, valB, valC) {\n  switch (icode) {\n    case IRMMOVQ:\n    case IMRMOVQ:\n    case IOPQ:\n    case ICALL:\n    case IPUSHQ:\n    case IRET:\n    case IPOPQ:\n      return valB;\n\n    case IRRMOVQ:\n    case IIRMOVQ:\n      return VALZERO;\n    //other operation don't need aluB\n    default:\n      return VALZERO;\n  }\n}\n//long long: return, a, b, t\n//!alu_cc global, modify it also\nfunction check_e_valE(alufun, valA, valB) {\n  return ops(valA, valB, alufun);\n}\n\n//return bool\n/************ modify it ***********/\nfunction check_e_cond(ifun) {\n  switch (ifun) {\n    case 1:\n      return CC & (ZF | SF);\n    case 2:\n      return CC & SF;\n    case 3:\n      return CC & ZF;\n    case 4:\n      return !(CC & ZF);\n    case 5:\n      return !(CC & SF);\n    case 6:\n      return !(CC & (ZF | SF));\n    default:\n      return true;\n  }\n}\n\n//long long: return, valA, valE\nfunction check_m_mem_addr(icode, valA, valE) {\n  switch (icode) {\n    case IRMMOVQ:\n    case IPUSHQ:\n    case ICALL:\n    case IMRMOVQ:\n      return valE;\n\n    case IPOPQ:\n    case IRET:\n      return valA;\n    default:\n      return VALZERO;\n  }\n}\n\nfunction doFetch() {\n  /* Stage values */\n  //bool\n  let instr_valid, need_regids, need_valC;\n  //let imem_error;\n\n  let stat;\n\n  /* should be long long */\n  let pc;\n  let predPC;\n  let valC, valP;\n\n  //int\n  let split, align;\n  let icode, ifun;\n  let rA, rB;\n\n  /** Select PC **/\n\n  //now pc is a int\n  pc = parseInt(valToHex(check_f_pc()), 16);\n  //console.log(\"pc is\" + pc);\n  /** Fetch **/\n  split = readMemory(pc, 1);\n  align = readMemory(pc + 1, 1);\n  //console.log(split);\n  //console.log(align);\n  icode = parseInt(split[0][0], 16);\n  ifun = parseInt(split[0][1], 16);\n  //console.log(\"icode: \" + icode + \", ifun\" + ifun);\n\n  //bool\n  instr_valid = check_f_instr_valid(icode, ifun);\n  need_regids = check_f_need_regids(icode);\n  need_valC = check_f_need_valC(icode);\n  //console.log(need_regids);\n  stat = check_f_stat(imem_error, instr_valid, icode);\n\n  rA = need_regids ? parseInt(align[0][0], 16) : RNONE;\n  rB = need_regids ? parseInt(align[0][1], 16) : RNONE;\n\n  valC = need_valC ? readMemory(pc + 1 + need_regids) : VALZERO.slice();\n\n  valP = intToVal(pc + 1 + need_regids + (need_valC << 3));\n\n  predPC =\n    icode == IJXX || icode == ICALL\n      ? intToVal(parseInt(valToHex(valC), 16))\n      : valP;\n\n  /** Update **/\n  f_stat = stat;\n  f_icode = icode;\n  f_ifun = ifun;\n  f_rA = rA;\n  f_rB = rB;\n  f_valC = valC.slice();\n  f_valP = valP.slice();\n  f_predPC = predPC.slice();\n  /*\n  console.log(\"f_stat: \" + f_stat);\n  console.log(\"f_icode: \" + f_icode);\n  console.log(\"f_ifun: \" + f_ifun);\n  console.log(\"f_rA: \" + f_rA);\n  console.log(\"f_rB:\" + f_rB);\n\n  console.log(\"f_valC: \" + f_valC);\n  console.log(\"f_valP: \" + f_valP);\n  console.log(\"f_predPC: \" + f_predPC);*/\n}\nfunction doDecode() {\n  let stat;\n\n  let rvalA, rvalB;\n  let dstE, dstM;\n  let valA, valB;\n\n  let srcA, srcB;\n\n  dstE = check_d_dstE();\n  dstM = check_d_dstM();\n  srcA = check_d_srcA();\n  srcB = check_d_srcB();\n\n  registerFile.srcA = srcA;\n  registerFile.srcB = srcB;\n  ///read registerFile as if it were a combinational logic\n  ///i.e. update the read port A B immediately.\n  registerFile.read();\n\n  //should not be modified;\n  rvalA = registerFile.A;\n  rvalB = registerFile.B;\n\n  /** Sel + Fwd A and Fwd B **/\n  valA = check_d_valA(srcA, rvalA);\n  valB = check_d_valB(srcB, rvalB);\n\n  /** Update **/\n  Stat = W_stat == SBUB ? SAOK : W_stat;\n\n  d_stat = D_stat;\n  d_icode = D_icode;\n  d_ifun = D_ifun;\n  d_valC = D_valC.slice();\n  d_valA = valA.slice();\n  d_valB = valB.slice();\n  d_dstE = dstE;\n  d_dstM = dstM;\n  d_srcA = srcA;\n  d_srcB = srcB;\n\n  /** print **/\n\n  console.log(\"d_stat: \" + d_stat);\n  console.log(\"d_icode: \" + d_icode);\n  console.log(\"d_ifun: \" + d_ifun);\n  console.log(\"d_valC: \" + d_valC);\n  console.log(\"d_valA: \" + d_valA);\n  console.log(\"d_valB: \" + d_valB);\n  console.log(\"d_dstE: \" + d_dstE);\n\n  return 0;\n}\nfunction doExecute() {\n  //alu_cc;//!cc from alu\n  let cond;\n  let alufun;\n  let dstE;\n\n  let aluA, aluB;\n  let valE;\n\n  alufun = E_icode == IOPQ ? E_ifun : ALUADD;\n  aluA = check_e_aluA(E_icode, E_valA, E_valC);\n  aluB = check_e_aluB(E_icode, E_valB, E_valC);\n\n  set_cc =\n    E_icode == IOPQ &&\n    !(\n      m_stat == SADR ||\n      m_stat == SINS ||\n      m_stat == SHLT ||\n      (W_stat == SADR || W_stat == SINS || W_stat == SHLT)\n    );\n\n  //!also update alu_cc\n  valE = ops(aluB, aluA, alufun);\n\n  cond = !!check_e_cond(E_ifun);\n  //!update dstE according to condition codes\n  dstE = E_icode == IRRMOVQ ? (cond ? E_dstE : RNONE) : E_dstE;\n\n  /** Update **/\n  if (set_cc) {\n    CC = alu_cc;\n    console.log(\"updateCC: \" + CC);\n  }\n\n  e_stat = E_stat;\n  e_icode = E_icode;\n  e_Cnd = cond;\n  e_valE = valE.slice();\n  e_valA = E_valA.slice();\n  e_dstE = dstE;\n  e_dstM = E_dstM;\n  /*\n  console.log(\"CC: \" + CC);\n  console.log(\"e_stat: \" + e_stat);\n  console.log(\"e_icode: \" + e_icode);\n  console.log(\"e_Cnd: \" + e_Cnd);\n  console.log(\"e_valE: \" + e_valE);\n  console.log(\"e_valA: \" + e_valA);\n  console.log(\"e_dstE: \" + e_dstE);\n  console.log(\"e_dstM: \" + e_dstM);\n  */\n}\nfunction doMemory() {\n  let stat;\n  dmem_error = false;\n  let mem_read, mem_write;\n  //long long\n  let data_in, addr;\n  let valM = VALZERO.slice();\n\n  mem_read = M_icode == IMRMOVQ || M_icode == IPOPQ || M_icode == IRET;\n  mem_write = M_icode == IRMMOVQ || M_icode == IPUSHQ || M_icode == ICALL;\n\n  addr = parseInt(valToHex(check_m_mem_addr(M_icode, M_valA, M_valE)), 16);\n  data_in = M_valA;\n\n  if (mem_read) valM = readMemory(addr, 8);\n\n  let temp = 1;\n  if (mem_write) {\n    temp = writeMemory(addr, data_in);\n  }\n  if (valM == null || temp == null) dmem_error = true;\n\n  stat = dmem_error ? SADR : M_stat;\n\n  /** Update **/\n  m_stat = stat;\n  m_icode = M_icode;\n  m_valE = M_valE.slice();\n  m_valM = valM.slice();\n  m_dstE = M_dstE;\n  m_dstM = M_dstM;\n\n  console.log(\"\");\n}\nfunction doWriteback() {\n  Stat = W_stat == SBUB ? SAOK : W_stat;\n\n  registerFile.dstE = W_dstE;\n  registerFile.dstM = W_dstM;\n  registerFile.E = W_valE.slice();\n  registerFile.M = W_valM.slice();\n}\n\nfunction doControlLogic() {\n  let mispredicted_branch = E_icode == IJXX && !e_Cnd;\n  let load_use_hazard =\n    (E_icode == IMRMOVQ || E_icode == IPOPQ) &&\n    (E_dstM == d_srcA || E_dstM == d_srcB);\n  let exception =\n    m_stat == SADR ||\n    m_stat == SINS ||\n    m_stat == SHLT ||\n    (W_stat == SADR || W_stat == SINS || W_stat == SHLT);\n\n  F_stall =\n    load_use_hazard || (D_icode == IRET || E_icode == IRET || M_icode == IRET);\n  F_bubble = false;\n\n  D_stall = load_use_hazard;\n  D_bubble =\n    (E_icode == IJXX && !e_Cnd) ||\n    (!(\n      (E_icode == IMRMOVQ || E_icode == IPOPQ) &&\n      (E_dstM == d_srcA || E_dstM == d_srcB)\n    ) &&\n      (D_icode == IRET || E_icode == IRET || M_icode == IRET));\n\n  E_stall = false;\n  E_bubble = mispredicted_branch || load_use_hazard;\n\n  W_stall = W_stat == SADR || W_stat == SINS || W_stat == SHLT;\n  W_bubble = false;\n\n  M_stall = false;\n  M_bubble =\n    W_stat == SADR ||\n    W_stat == SINS ||\n    W_stat == SHLT ||\n    (m_stat == SADR || m_stat == SINS || m_stat == SHLT);\n}\n\nfunction resetW() {\n  W_stall = false;\n  W_bubble = true;\n  W_stat = SBUB;\n  W_icode = INOP;\n  W_valE = VALZERO.slice();\n  W_valM = VALZERO.slice();\n  W_dstE = RNONE;\n  W_dstM = RNONE;\n}\nfunction resetM() {\n  M_stall = false;\n  M_bubble = true;\n  M_stat = SBUB;\n  M_icode = INOP;\n  M_valA = VALZERO.slice();\n  M_valE = VALZERO.slice();\n  M_dstE = RNONE;\n  M_dstM = RNONE;\n  M_Cnd = 0;\n}\nfunction resetE() {\n  E_stall = false;\n  E_bubble = true;\n  E_stat = SBUB;\n  E_icode = INOP;\n  E_ifun = 0;\n  E_valA = VALZERO.slice();\n  E_valB = VALZERO.slice();\n  E_valC = VALZERO.slice();\n  E_srcA = RNONE;\n  E_srcB = RNONE;\n  E_dstE = RNONE;\n  E_dstM = RNONE;\n}\n\nfunction resetD() {\n  D_stall = false;\n  D_bubble = true;\n  D_stat = SBUB;\n  D_icode = INOP;\n  D_ifun = 0;\n  D_rA = RNONE;\n  D_rB = RNONE;\n  D_valC = VALZERO.slice();\n  D_valP = VALZERO.slice();\n}\nfunction resetF() {\n  F_stall = false;\n  F_bubble = true;\n  F_predPC = VALZERO.slice();\n}\n\nfunction updateStageRegisters() {\n  if (W_bubble) {\n    resetW();\n  } else if (!W_stall) {\n    W_stat = m_stat;\n    W_icode = m_icode;\n    W_valE = m_valE.slice();\n    W_valM = m_valM.slice();\n    W_dstE = m_dstE;\n    W_dstM = m_dstM;\n  }\n\n  if (M_bubble) {\n    resetM();\n  } else if (!W_stall) {\n    M_stat = e_stat;\n    M_icode = e_icode;\n    M_valA = e_valA.slice();\n    M_valE = e_valE.slice();\n    M_dstE = e_dstE;\n    M_dstM = e_dstM;\n    M_Cnd = e_Cnd;\n  }\n\n  if (E_bubble) {\n    resetE();\n  } else if (!E_stall) {\n    E_stat = d_stat;\n    E_icode = d_icode;\n    E_ifun = d_ifun;\n    E_valA = d_valA.slice();\n    E_valB = d_valB.slice();\n    E_valC = d_valC.slice();\n    E_srcA = d_srcA;\n    E_srcB = d_srcB;\n    E_dstE = d_dstE;\n    E_dstM = d_dstM;\n  }\n\n  if (D_bubble) {\n    resetD();\n  } else if (!D_stall) {\n    D_stat = f_stat;\n    D_icode = f_icode;\n    D_ifun = f_ifun;\n    D_rA = f_rA;\n    D_rB = f_rB;\n    D_valC = f_valC.slice();\n    D_valP = f_valP.slice();\n  }\n  if (F_bubble) {\n    resetF();\n    //!no stat in regF\n  } else if (!F_stall) F_predPC = f_predPC;\n}\nfunction init() {\n  /* reset memory */\n  Memory = [\"0\"];\n  Memory.length = MAX_MEM;\n  /* reset the caches */\n  for (let i = 0; i < cache.length; i++) {\n    cache[i].reset();\n  }\n  /** reset registerFile **/\n  registerFile.reset();\n\n  /** reset stage registers**/\n  resetF();\n  resetD();\n  resetE();\n  resetM();\n  resetW();\n\n  /** reset Condition Code **/\n  CC = ZF;\n\n  /** reset Stat **/\n  Stat = SAOK;\n}\n\nfunction printStageRegisters() {\n  console.log(\"[Writeback]\");\n  console.log(\n    \"stat[\" +\n      W_stat +\n      \"] icode[\" +\n      W_icode +\n      \"] valE[\" +\n      W_valE +\n      \"] valM[\" +\n      W_valM +\n      \"] dstE[\" +\n      W_dstE +\n      \"]\" +\n      \"] dstM[\" +\n      W_dstM +\n      \"]\"\n  );\n  console.log(\"[Memory]\");\n  console.log(\n    \"stat[\" +\n      M_stat +\n      \"]  icode[\" +\n      M_icode +\n      \"]  Cnd[\" +\n      M_Cnd +\n      \"]  valE[\" +\n      M_valE +\n      \"]  valA[\" +\n      M_valA +\n      \"]  dstE[\" +\n      M_dstE +\n      \"]  dstM[\" +\n      M_dstM +\n      \"]\"\n  );\n  console.log(\"[Execute]\");\n  console.log(\n    \"stat[\" +\n      E_stat +\n      \"]  icode[\" +\n      E_icode +\n      \"]  ifun[\" +\n      E_ifun +\n      \"]  valC[\" +\n      E_valC +\n      \"]  valA[\" +\n      E_valA +\n      \"]  valB[\" +\n      E_valB +\n      \"]  dstE[\" +\n      E_dstE +\n      \"]  dstM[\" +\n      E_dstM +\n      \"]  srcA[\" +\n      E_srcA +\n      \"]  srcB[\" +\n      E_srcB +\n      \"]\"\n  );\n  console.log(\"[Decode]\");\n  console.log(\n    \"stat[\" +\n      D_stat +\n      \"]  icode[\" +\n      D_icode +\n      \"]  ifun[\" +\n      D_ifun +\n      \"]  rA[\" +\n      D_rA +\n      \"]  rB[\" +\n      D_rB +\n      \"]  valC[\" +\n      D_valC +\n      \"]  valP[\" +\n      D_valP +\n      \"]\"\n  );\n  console.log(\"[Fetch]\");\n  console.log(\"predPC[\" + F_predPC + \"]\");\n}\nfunction stepi(steps) {\n  for (let i = 0; i < steps; i++) {\n    step();\n  }\n  if (Stat == SINS || Stat == SADR || Stat == SHLT) {\n    return Stat;\n  }\n  return 0;\n}\nfunction step() {\n  /** Exception **/\n\n  if (Stat == SINS || Stat == SADR || Stat == SHLT) {\n    return 1;\n  }\n  //console.log(\"clock cycle begins!\");\n  /** clock cycle begins **/\n\n  ///update the stage registers and registerFile\n  updateStageRegisters();\n  registerFile.write();\n\n  ///running pipeline\n  doWriteback();\n  doMemory();\n  doExecute();\n  doDecode();\n  doFetch();\n\n  ///update the control logic\n  doControlLogic();\n\n  /** clock cycle ends **/\n  //console.log(\"clock cycle ends\");\n  //printStageRegisters();\n  //console.log(registerFile);\n  return 0;\n}\n","import React, { Fragment } from \"react\";\nimport Draggable from \"react-draggable\";\n\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport Popover from \"@material-ui/core/Popover\";\n\nimport Card from \"@material-ui/core/Card\";\nimport CardHeader from \"@material-ui/core/CardHeader\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\n\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\n\nimport Zoom from \"@material-ui/core/Zoom\";\nimport Grow from \"@material-ui/core/Grow\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport Slide from \"@material-ui/core/Slide\";\n\nimport red from \"@material-ui/core/colors/red\";\nimport blue from \"@material-ui/core/colors/blue\";\nimport green from \"@material-ui/core/colors/green\";\nimport brown from \"@material-ui/core/colors/brown\";\nimport yellow from \"@material-ui/core/colors/yellow\";\nimport orange from \"@material-ui/core/colors/orange\";\nimport deepOrange from \"@material-ui/core/colors/deepOrange\";\nimport purple from \"@material-ui/core/colors/purple\";\n\nimport grey from \"@material-ui/core/colors/grey\";\n\nimport PropTypes from \"prop-types\";\nimport {\n  MuiThemeProvider,\n  createMuiTheme,\n  withStyles\n} from \"@material-ui/core/styles\";\nimport Button from \"@material-ui/core/Button\";\nimport Fab from \"@material-ui/core/Fab\";\nimport Avatar from \"@material-ui/core/Avatar\";\n\nimport Drawer from \"@material-ui/core/Drawer\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport List from \"@material-ui/core/List\";\n\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Divider from \"@material-ui/core/Divider\";\nimport InboxIcon from \"@material-ui/icons/MoveToInbox\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport MenuIcon from \"@material-ui/icons/Menu\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport InfoIcon from \"@material-ui/icons/Info\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport ReorderIcon from \"@material-ui/icons/Reorder\";\nimport FilterListIcon from \"@material-ui/icons/FilterList\";\nimport PauseIcon from \"@material-ui/icons/Pause\";\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport ShareIcon from \"@material-ui/icons/Share\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\n\nimport TextField from \"@material-ui/core/TextField\";\n\nimport MailIcon from \"@material-ui/icons/Mail\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Grid from \"@material-ui/core/Grid\";\nimport InputBase from \"@material-ui/core/InputBase\";\n\nimport ExpansionPanel from \"@material-ui/core/ExpansionPanel\";\nimport ExpansionPanelSummary from \"@material-ui/core/ExpansionPanelSummary\";\nimport ExpansionPanelDetails from \"@material-ui/core/ExpansionPanelDetails\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\n\nimport Snackbar from \"@material-ui/core/Snackbar\";\n\nimport { Pipe } from \"./pipe.js\";\nconst appBarTitle = \"COLORFUL CPU\";\n\nconst stats = [\"\", \"SAOK\", \"SADR\", \"SINS\", \"SHLT\", \"SBUB\"];\nconst aboutText =\n  \"A Pipe-line Y86-64 CPU Simulator using React and Matreial-ui by Leehq\";\nlet stageColor = [red[500], purple[500], orange[500], green[500], blue[500]];\n\nlet stageRefreshTimeout = 500;\n\nlet runTimeout = 1000;\nconst speedOpt = [1, 5, 10, 20];\n\nlet colorDel = 1;\nlet pipe = new Pipe();\npipe.init();\nlet breakPoints = new Set();\n\nconst appBarHeight = 70;\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: brown,\n    //secondary: ,\n    background: {\n      default: grey[200]\n    }\n  },\n  typography: {\n    useNextVariants: true,\n    fontSize: 13,\n    fontFamily: [\n      \"Consolas\",\n      \"Courier New\",\n      '\"Microsoft Yahei\"',\n      \"-apple-system\",\n      \"BlinkMacSystemFont\",\n      '\"Segoe UI\"',\n      \"Roboto\",\n      '\"Helvetica Neue\"',\n      \"Arial\",\n      \"sans-serif\",\n      '\"Apple Color Emoji\"',\n      '\"Segoe UI Emoji\"',\n      '\"Segoe UI Symbol\"'\n    ].join(\",\")\n  }\n});\nconsole.log(theme);\nconst styles = theme => ({\n  root: {\n    display: \"flex\",\n    width: \"100%\",\n    height: \"100%\",\n    backgroundColor: grey[200]\n  },\n  appBar: {\n    height: appBarHeight\n  },\n  toolbar: {\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  },\n  drawer: {\n    width: 240,\n    flexShrink: 0\n  },\n\n  content: {\n    height: \"100%\",\n    width: \"100%\",\n    backgroundColor: grey[200],\n    paddingTop: appBarHeight + theme.spacing.unit * 3,\n    padding: theme.spacing.unit * 3\n  },\n  table: {\n    width: \"100%\"\n  },\n  row: {},\n  paper: {\n    overflow: \"auto\",\n    padding: 10,\n    height: \"100%\",\n    width: \"100%\"\n  },\n  details: {\n    //justifyItems: \"center\",\n    width: \"100%\",\n    overflowX: \"auto\"\n  },\n  textField: {\n    width: \"100%\",\n    rows: 10,\n    rowsMax: 10\n  },\n  panel: {\n    paddingLeft: 10,\n    overflowX: \"auto\",\n    width: \"100%\"\n    //height: \"100%\"\n  },\n  subHeader: {\n    //backgroundColor:\n    backgroundColor: theme.palette.background.paper\n  },\n  text: {\n    paddingTop: theme.spacing.unit * 2,\n    paddingLeft: theme.spacing.unit * 2,\n    paddingRight: theme.spacing.unit * 2\n  }\n});\n\nclass StageCards extends React.Component {\n  state = {\n    grow: [true, false, false, false, false, false],\n    stageRegisters: this.props.stageRegisters,\n    onRefresh: false,\n    in: true,\n    x: 0,\n    y: 0,\n    position: [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]],\n    ref: [undefined, undefined, undefined, undefined, undefined]\n  };\n  changePosition(index) {\n    let rect = this.ref[index].getBoundingClientRect();\n    let randX = Math.random();\n    let randY = Math.random();\n\n    let x =\n      (window.innerWidth / 5 - rect.width / 2) * randX +\n      ((window.innerWidth * 4) / 5 - rect.width / 2) * (1 - randX);\n    let y =\n      (window.innerHeight / 3 - rect.height / 2) * randY +\n      ((window.innerHeight * 2) / 3 - rect.height / 2) * (1 - randY);\n    let newPos = this.state.position;\n    newPos[index][0] = x;\n    newPos[index][1] = y;\n    this.setState({\n      position: newPos\n    });\n  }\n\n  componentDidMount() {\n    for (let i = 0; i < 5; i++) this.changePosition(i);\n  }\n  render() {\n    const time = runTimeout / 10;\n    const timeout = time > 200 ? time : 200;\n    const delay = timeout >> 2;\n    if (this.ref == undefined) {\n      this.ref = [];\n      this.ref.length = 5;\n    }\n\n    const { classes } = this.props;\n    const stages = [\"Write-back\", \"Memory\", \"Execute\", \"Decode\", \"Fetch\"];\n    //console.log(\"render\");\n    const stageRegisters = this.props.stageRegisters;\n\n    //this.setState({refresh:this.props.refresh});\n    return stages.map((name, index) => (\n      <div\n        style={{\n          position: \"absolute\",\n          zIndex: 10,\n          left: this.state.position[index][0],\n          top: this.state.position[index][1]\n        }}\n        ref={ref => {\n          this.ref[index] = ref;\n        }}\n      >\n        <React.Fragment>\n          <Grow\n            unmountOnExit\n            //mountOnEnter\n\n            in={\n              index == 0 && !this.state.onRefresh\n                ? !this.props.hide\n                : this.state.grow[index]\n            }\n            timeout={timeout}\n            onEnter={() => {\n              //console.log(index+\" enter\");\n              if (index == 0) this.setState({ onRefresh: true });\n              setTimeout(() => {\n                let newGrow = this.state.grow;\n                newGrow[index + 1] = true;\n                this.setState({ grow: newGrow });\n              }, delay);\n            }}\n            onEntered={() => {\n              if (index == 4) {\n                let newGrow = this.state.grow;\n                newGrow[0] = false;\n                this.setState({ grow: newGrow });\n              }\n            }}\n            onExit={() => {\n              //console.log(index+\" exit\");\n              if (index == 0) {\n                this.setState({ onRefresh: true });\n              }\n              setTimeout(() => {\n                let newGrow = this.state.grow;\n                newGrow[index + 1] = false;\n                this.setState({ grow: newGrow });\n              }, delay);\n            }}\n            onExited={() => {\n              //console.log(index + \" exited\");\n              //console.log(\"******set state\");\n              this.changePosition(index);\n              if (index == 4) {\n                this.setState({\n                  onRefresh: false,\n                  stageRegisters: this.props.stageRegisters\n                });\n                if (this.props.hide) return;\n                let newGrow = this.state.grow;\n                newGrow[0] = true;\n                this.setState({ grow: newGrow });\n                //this.setState({ in: true });\n              }\n            }}\n          >\n            <Card>\n              <CardActionArea\n                style={{\n                  backgroundColor:\n                    this.state.stageRegisters[index][0][1] === \"SAOK\" ||\n                    index == 4\n                      ? stageColor[index]\n                      : grey[500]\n                }}\n              >\n                <CardHeader\n                  avatar={\n                    <Avatar\n                      style={{\n                        backgroundColor:\n                          this.state.stageRegisters[index][0][1] === \"SAOK\" ||\n                          index == 4\n                            ? stageColor[index]\n                            : grey[500]\n                      }}\n                    >\n                      {name[0]}\n                    </Avatar>\n                  }\n                  title={name}\n                />\n              </CardActionArea>\n              <CardContent>\n                {this.state.stageRegisters[index].map((prop, index) => (\n                  <Typography component=\"p\">\n                    {prop[1] == \"\" ? \"\" : \"[\" + prop[0] + \"] \" + prop[1] + \" \"}{\" \"}\n                  </Typography>\n                ))}\n              </CardContent>\n            </Card>\n          </Grow>\n        </React.Fragment>\n      </div>\n    ));\n  }\n}\n\nclass CodeLayout extends React.Component {\n  render() {\n    const { classes } = this.props;\n    const parent = this.props.parent;\n    let code = this.props.code;\n    let stageRegisters = pipe.getStageRegisters();\n\n    //displace begin\n    return (\n      <div style={{ height: \"100%\" }}>\n        <Paper\n          style={{\n            padding: theme.spacing.unit * 2,\n            height: \"100%\",\n            overflow: \"auto\"\n          }}\n        >\n          {code.map((line, index) => {\n            let address;\n            if (line.length >= 5 && line[0] == \"0\" && line[1] == \"x\") {\n              let i = 2;\n              address = \"\";\n              while (line[i] == \"0\") {\n                i++;\n              }\n              while (line[i] != \":\") {\n                address += line[i++];\n              }\n              if (address.length == 0) address = \"0\";\n            }\n\n            return (\n              <div>\n                <Typography\n                  addr={address}\n                  //classes={addr}\n                  style={{\n                    fontSize: 15\n                  }}\n                  onContextMenu={() => {}}\n                  onDoubleClick={event => {\n                    let nameMap = event.target.attributes;\n                    if (nameMap.addr == undefined) return;\n                    if (event.target.isbreakpoint) {\n                      event.target.isbreakpoint = false;\n                      //delete breakpoint\n                      pipe.deleteBreakpoint(nameMap.addr.value);\n                      breakPoints.delete(nameMap.addr.value);\n                      parent.toast(\n                        \"Delete breakpoint at: 0x\" + nameMap.addr.value\n                      );\n                      event.target.style.fontWeight = \"normal\";\n                    } else {\n                      event.target.isbreakpoint = true;\n                      //add in break point;\n                      pipe.addBreakpoint(nameMap.addr.value);\n                      breakPoints.add(nameMap.addr.value);\n                      parent.toast(\n                        \"Add breakpoint at: 0x\" + nameMap.addr.value\n                      );\n                      event.target.style.fontWeight = \"bold\";\n                    }\n                  }}\n                  onMouseEnter={event => {\n                    //console.log(\"mouse in\");\n                    //console.log(event.clientX);\n                    event.target.style.fontWeight = \"bold\";\n                  }}\n                  onMouseOut={event => {\n                    if (!event.target.isbreakpoint)\n                      event.target.style.fontWeight = \"normal\";\n                  }}\n                >\n                  {line}\n                </Typography>\n              </div>\n            );\n          })}\n          {\n            //}    </List>\n          }{\" \"}\n        </Paper>\n      </div>\n    );\n  }\n}\n\nclass StageRegistersLayout extends React.Component {\n  state = {\n    grow: [true, false, false, false, false, false],\n    stageRegisters: this.props.stageRegisters,\n    stageStuffs: this.props.stageStuffs,\n    onRefresh: false,\n    in: true,\n    anchorEl: null,\n    popText: \"\"\n  };\n\n  render() {\n    const delay = 10;\n    const timeout = 200;\n\n    const { classes } = this.props;\n    const stages = [\"Write-back\", \"Memory\", \"Execute\", \"Decode\", \"Fetch\"];\n    //console.log(\"render\");\n    const stageRegisters = this.props.stageRegisters;\n    const stageStuffs = this.props.stageStuffs;\n    const { anchorEl } = this.state;\n    //this.setState({refresh:this.props.refresh});\n    return (\n      <div style={{ height: \"100%\", width: \"100%\" }}>\n        <Paper style={{ height: \"100%\", overflow: \"auto\" }}>\n          <List className={classes.list}>\n            <ListSubheader className={classes.subHeader}>\n              Stage Registers\n            </ListSubheader>\n\n            <Popover\n              id=\"simple-popper\"\n              open={Boolean(anchorEl)}\n              anchorEl={anchorEl}\n              onClose={() => {\n                this.setState({\n                  anchorEl: null\n                });\n              }}\n              anchorOrigin={{\n                vertical: \"bottom\",\n                horizontal: \"center\"\n              }}\n              transformOrigin={{\n                vertical: \"top\",\n                horizontal: \"center\"\n              }}\n            >\n              <Typography style={{ margin: theme.spacing.unit * 2 }}>\n                {this.state.popText}\n              </Typography>\n            </Popover>\n\n            {stages.map((name, index) => (\n              <React.Fragment>\n                <Grow\n                  in={\n                    index == 0 && !this.state.onRefresh\n                      ? this.props.hide\n                        ? false\n                        : this.props.in\n                      : this.state.grow[index]\n                  }\n                  timeout={timeout}\n                  onEnter={() => {\n                    //console.log(index+\" enter\");\n                    setTimeout(() => {\n                      let newGrow = this.state.grow;\n                      newGrow[index + 1] = true;\n                      this.setState({ grow: newGrow });\n                    }, delay);\n                  }}\n                  onEntered={() => {\n                    //console.log(index + \" entered \");\n                    //console.log(\" onrefresh\"+this.state.onRefresh);\n                    //console.log(\"props in \"+this.props.in);\n                    if (index == 4) {\n                      this.setState({ onRefresh: false });\n                      this.setState({ in: false });\n                    }\n                  }}\n                  onExit={() => {\n                    //console.log(index+\" exit\");\n                    if (index == 0) {\n                      let newGrow = this.state.grow;\n                      newGrow[0] = false;\n                      this.setState({ grow: newGrow });\n                      this.setState({ onRefresh: true });\n                    }\n                    setTimeout(() => {\n                      let newGrow = this.state.grow;\n                      newGrow[index + 1] = false;\n                      this.setState({ grow: newGrow });\n                    }, delay);\n                  }}\n                  onExited={() => {\n                    //console.log(index + \" exited\");\n                    //console.log(\"******set state\");\n                    if (index == 4) {\n                      let newGrow = this.state.grow;\n                      newGrow[0] = true;\n                      this.setState({ grow: newGrow });\n                      this.setState({\n                        stageRegisters: this.props.stageRegisters\n                      });\n                      //this.setState({ in: true });\n                    }\n                  }}\n                >\n                  <ListItem\n                    button\n                    onClick={event => {\n                      this.setState({\n                        popText: this.props.stageStuffs[index].map(\n                          (prop, index) =>\n                            prop[1] == \"\" || prop[1] == undefined\n                              ? \"\"\n                              : \"[\" + prop[0] + \"] \" + prop[1] + \" \"\n                        ),\n                        anchorEl: event.currentTarget\n                      });\n                    }}\n                  >\n                    <Avatar\n                      style={{\n                        backgroundColor:\n                          this.state.stageRegisters[index][0][1] === \"SAOK\" ||\n                          index == 4\n                            ? stageColor[index]\n                            : grey[500]\n                      }}\n                    >\n                      {\" \"}\n                      {name[0]}\n                    </Avatar>\n\n                    <ListItemText\n                      primary={this.state.stageRegisters[index].map(\n                        (prop, index) =>\n                          prop[1] == \"\"\n                            ? \"\"\n                            : \"[\" + prop[0] + \"] \" + prop[1] + \" \"\n                      )}\n                    />\n                  </ListItem>\n                </Grow>\n              </React.Fragment>\n            ))}\n          </List>\n        </Paper>\n      </div>\n    );\n  }\n}\n\nclass RegisterFileLayout extends React.Component {\n  regs = [\n    \"rax\",\n    \"rcx\",\n    \"rdx\",\n    \"rbx\",\n    \"rsp\",\n    \"rbp\",\n    \"rsi\",\n    \"rdi\",\n    \"r8\",\n    \"r9\",\n    \"r10\",\n    \"r11\",\n    \"r12\",\n    \"r13\",\n    \"r14\",\n    \"rnone\"\n  ];\n  render() {\n    const { classes } = this.props;\n    let r = pipe.getRegisterFile();\n    return (\n      <div style={{ width: \"100%\" }}>\n        <Table className={classes.table}>\n          <TableHead>\n            <TableRow className={classes.row}>\n              {this.regs.map(\n                (name, index) =>\n                  index < 8 && (\n                    <TableCell style={{ textAlign: \"center\", flexGrow: 1 }}>\n                      {name}\n                    </TableCell>\n                  )\n              )}\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            <TableRow className={classes.row}>\n              {r.map(\n                (val, index) =>\n                  index < 8 && (\n                    <TableCell style={{ textAlign: \"center\" }}>{val}</TableCell>\n                  )\n              )}\n            </TableRow>\n          </TableBody>\n          <TableHead>\n            <TableRow className={classes.row}>\n              {this.regs.map(\n                (name, index) =>\n                  index >= 8 && (\n                    <TableCell style={{ textAlign: \"center\" }}>\n                      {name}\n                    </TableCell>\n                  )\n              )}\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            <TableRow className={classes.row}>\n              {r.map(\n                (val, index) =>\n                  index >= 8 && (\n                    <TableCell style={{ textAlign: \"center\" }}>{val}</TableCell>\n                  )\n              )}\n            </TableRow>\n          </TableBody>\n        </Table>\n      </div>\n    );\n  }\n}\n\nclass CacheLayout extends React.Component {\n  state = {\n    cache: this.props.cache,\n    open: undefined,\n    expanded: [false]\n  };\n  init(ini) {\n    console.log(\"init\");\n    let a = [];\n    let cache = this.props.cache;\n\n    a.length = cache.length;\n    for (let i = 0; i < cache.length; i++) {\n      a[i] = [];\n      a[i].length = cache[i].set.length;\n\n      for (let j = 0; j < cache[i].set.length; j++) {\n        a[i][j] = [];\n        a[i][j].length = cache[i].set[j].length;\n        for (let k = 0; k < cache[i].set[j].length; k++) {\n          a[i][j][k] = ini;\n        }\n      }\n    }\n    console.log(a);\n    return a;\n  }\n\n  render() {\n    const h = window.innerHeight;\n    const w = window.innerWidth;\n    //const cache = pipe.getCache();\n    const cache = this.props.cache;\n    let open = this.state.open;\n    let t = this;\n\n    return cache.map((cac, index) => {\n      return (\n        <Draggable>\n          <ExpansionPanel\n            expanded={\n              this.state.expanded[index] == undefined\n                ? false\n                : this.state.expanded[index]\n            }\n            style={{\n              position: \"absolute\",\n              top: (h / 3) * 1 + theme.spacing.unit * 3 * index,\n              left: (w / 3) * 1 + theme.spacing.unit * 10 * index\n            }}\n          >\n            <ExpansionPanelSummary\n              expandIcon={\n                <ExpandMoreIcon\n                  onClick={e => {\n                    let exp = this.state.expanded;\n                    if (index >= exp.length) {\n                      exp.length = index;\n                      exp[index] = false;\n                    }\n                    exp[index] = !exp[index];\n                    this.setState({ expanded: exp });\n                    //console.log(\"click more icon\");\n                  }}\n                />\n              }\n            >\n              <Typography>L{index + 1} Cache</Typography>\n            </ExpansionPanelSummary>\n\n            <ExpansionPanelDetails style={{ padding: 0 }}>\n              <List\n                dense\n                style={{ maxHeight: h / 2, overflow: \"auto\", padding: 0 }}\n              >\n                {!cac\n                  ? null\n                  : cac.set.map((set, si) => {\n                      return !set\n                        ? null\n                        : set.map((line, li) => {\n                            if (!line) return null;\n                            if (!line.valid) return null;\n                            let addrBegin =\n                              (line.tag << (cac.s + cac.b)) + (si << cac.b);\n                            let addrEnd =\n                              (line.tag << (cac.s + cac.b)) +\n                              ((si + 1) << cac.b) -\n                              1;\n                            let value = pipe.getValueFromMemory(\n                              addrBegin,\n                              addrEnd - addrBegin + 1\n                            );\n\n                            return (\n                              <Grow\n                                in={\n                                  this.props.in == undefined\n                                    ? true\n                                    : this.props.in[index] == undefined\n                                    ? true\n                                    : this.props.in[index][si] == undefined\n                                    ? true\n                                    : this.props.in[index][si][li]\n                                  //return true;\n                                }\n                              >\n                                <Tooltip\n                                  title={value}\n                                  open={\n                                    this.state.open == undefined\n                                      ? false\n                                      : this.state.open[index] == undefined\n                                      ? false\n                                      : this.state.open[index][si] == undefined\n                                      ? false\n                                      : this.state.open[index][si][li]\n                                  }\n                                  onClose={() => {\n                                    let newOpen = this.state.open;\n                                    if (\n                                      !newOpen ||\n                                      index >= newOpen.length ||\n                                      !newOpen[index] ||\n                                      si >= newOpen[index].length ||\n                                      !newOpen[index][si] ||\n                                      li >= newOpen[index][si].length\n                                    )\n                                      newOpen = this.init(false);\n                                    newOpen[index][si][li] = false;\n                                    this.setState({ open: newOpen });\n                                  }}\n                                >\n                                  <ListItem\n                                    button\n                                    onClick={() => {\n                                      let newOpen = this.state.open;\n                                      if (!newOpen) {\n                                        newOpen = this.init(false);\n                                        //console.log(newOpen);\n                                      }\n                                      newOpen[index][si][li] = !newOpen[index][\n                                        si\n                                      ][li];\n                                      this.setState({ open: newOpen });\n                                    }}\n                                  >\n                                    <Typography noWrap>\n                                      {\"0x\" +\n                                        addrBegin.toString(16) +\n                                        \"~\" +\n                                        \"0x\" +\n                                        addrEnd.toString(16)}\n                                    </Typography>\n                                  </ListItem>\n                                </Tooltip>\n                              </Grow>\n                            );\n                          });\n                    })}\n                ) }\n              </List>\n            </ExpansionPanelDetails>\n          </ExpansionPanel>\n        </Draggable>\n      );\n    });\n  }\n}\n\nclass MenuLayout extends React.Component {\n  state = {\n    settingExpanded: false,\n    openMemory: false,\n    openCache: false,\n    openAbout: false,\n    memory: [],\n    cache: [],\n    speedMenuOpen: false,\n    anchorEl: null,\n    speedIndex: 0\n  };\n  Transition(props) {\n    return <Slide direction=\"up\" {...props} />;\n  }\n\n  render() {\n    const mainLayout = this.props.parent;\n    const { anchorEl } = this.state;\n    return (\n      <div>\n        <List>\n          <ListItem>\n            <ListItemText primary=\"HELLO\" />\n          </ListItem>\n          <ListItem\n            button\n            onClick={() => {\n              this.setState({ settingExpanded: !this.state.settingExpanded });\n            }}\n          >\n            <ListItemIcon>\n              <SettingsIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"Setting\" />\n          </ListItem>\n          <Collapse\n            in={this.state.settingExpanded}\n            timeout=\"auto\"\n            unmountOnExit\n          >\n            <List component=\"div\" disablePadding>\n              <ListItem\n                button\n                onClick={event => {\n                  this.setState({ anchorEl: event.currentTarget });\n                }}\n              >\n                <ListItemText inset primary=\"Speed\" />\n              </ListItem>\n            </List>\n            <Menu\n              id=\"speed-menu\"\n              anchorEl={anchorEl}\n              open={Boolean(anchorEl)}\n              onClose={() => {\n                //runTimeout = 1000/ speedOpt[this.state.speedIndex];\n                //console.log(\"runtimeout:\"+runTimeout);\n                this.setState({ anchorEl: null });\n              }}\n            >\n              {speedOpt.map((option, index) => (\n                <MenuItem\n                  key={option}\n                  selected={index === this.state.speedIndex}\n                  onClick={event => {\n                    runTimeout = 1000 / speedOpt[index];\n                    console.log(\"runtimeout:\" + runTimeout);\n                    this.setState({ speedIndex: index, anchorEl: null });\n                  }}\n                >\n                  {speedOpt[index]}\n                </MenuItem>\n              ))}\n            </Menu>\n          </Collapse>\n\n          <ListItem\n            button\n            onClick={() => {\n              //show stack\n              this.setState({\n                openMemory: true,\n                memory: pipe.getMemory()\n              });\n            }}\n          >\n            <ListItemIcon>\n              <ReorderIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"Memory\" />\n          </ListItem>\n          <ListItem\n            button\n            onClick={event => {\n              this.setState({\n                openCache: true,\n                cache: pipe.getCache()\n              });\n            }}\n          >\n            <ListItemIcon>\n              <FilterListIcon\n                style={{\n                  transform: \"rotate(180deg)\"\n                }}\n              />\n            </ListItemIcon>\n            <ListItemText inset primary=\"Cache\" />\n          </ListItem>\n        </List>\n        <Divider />\n        <List>\n          <ListItem\n            button\n            key=\"About\"\n            onClick={() => {\n              this.setState({\n                openAbout: true\n              });\n            }}\n          >\n            <ListItemIcon>\n              <InfoIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"About\" />\n          </ListItem>\n        </List>\n\n        <Dialog\n          open={this.state.openMemory}\n          onClose={() => {\n            this.setState({ openMemory: false });\n          }}\n          scroll=\"paper\"\n          keepMounted\n          TransitionComponent={this.Transition}\n        >\n          <DialogTitle>Memory</DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              {this.state.memory.map((pair, index) => {\n                return (\n                  <Typography>{\"0x\" + pair[0] + \": \" + pair[1]}</Typography>\n                );\n              })}\n            </DialogContentText>\n          </DialogContent>\n        </Dialog>\n\n        <Dialog\n          open={this.state.openCache}\n          onClose={() => {\n            this.setState({ openCache: false });\n          }}\n          scroll=\"paper\"\n          keepMounted\n          TransitionComponent={this.Transition}\n        >\n          <DialogTitle>Cache Hierarchy</DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              {this.state.cache.map((cache, index) => {\n                return (\n                  <div>\n                    <Button style={{ textTransform: \"none\" }}>\n                      {\"L\" +\n                        (index + 1) +\n                        \": \" +\n                        \"t[\" +\n                        cache.t +\n                        \"] s[\" +\n                        cache.s +\n                        \"] b[\" +\n                        cache.b +\n                        \"]\"}\n                    </Button>\n                    <IconButton\n                      onClick={() => {\n                        pipe.removeCache(index);\n                        let cac = pipe.getCache();\n                        if (cac.length == 0) {\n                          this.setState({ openCache: false });\n                        } else this.setState({ cache: cac });\n                        mainLayout.initCache();\n                        mainLayout.refreshCache();\n                      }}\n                    >\n                      <DeleteIcon />\n                    </IconButton>\n                  </div>\n                );\n              })}\n            </DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button\n              onClick={event => {\n                let cac = pipe.getCache();\n                if (cac.length > 0)\n                  pipe.addCache(\n                    cac[cac.length - 1].t - 1,\n                    cac[cac.length - 1].s + 1\n                  );\n                else pipe.addCache();\n                this.setState({ cache: pipe.getCache() });\n                mainLayout.initCache();\n                mainLayout.refreshCache();\n              }}\n              color=\"primary\"\n            >\n              Add\n            </Button>\n          </DialogActions>\n        </Dialog>\n        <Dialog\n          open={this.state.openAbout}\n          onClose={() => {\n            this.setState({ openAbout: false });\n          }}\n          scroll=\"paper\"\n          keepMounted\n          TransitionComponent={this.Transition}\n        >\n          <DialogTitle>About</DialogTitle>\n          <DialogContent>\n            <DialogContentText>{aboutText}</DialogContentText>\n          </DialogContent>\n          <DialogActions />\n        </Dialog>\n      </div>\n    );\n  }\n}\n\nclass MainLayout extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleUpload = this.handleUpload.bind(this);\n    this.state = {\n      colorDeg: 45,\n      colorL: 350,\n      colorR: 25,\n      code: [\"Please upload a .yo file\"],\n      textHeight: \"100%\",\n      cardsHide: false,\n      cardsHalt: false,\n      fabIn: true,\n      onFabTransit: false,\n      fabTooltipOpen: false,\n      run: false,\n      drawerOpen: false,\n      onStageAnimation: false,\n      stageIn: true,\n      refreshStage: false,\n      messageQueue: [],\n      snackbarOpen: false,\n      anchorEl: null,\n      cacheIn: [[[]]],\n      cache: pipe.getCache(),\n      oldCache: pipe.getCache(),\n      stageRegisters: pipe.getStageRegisters(),\n      stageStuffs: pipe.getStageStuffs(),\n      registerFile: pipe.getRegisterFile()\n    };\n    this.textFieldDiv = React.createRef();\n  }\n  toast(msg) {\n    let msgQueue = this.state.messageQueue;\n    msgQueue.push(msg);\n    this.setState({\n      messageQueue: msgQueue,\n      snackbarOpen: !this.state.snackbarOpen\n    });\n  }\n\n  handleUpload(event) {\n    //console.log(event);\n    let fileReader = new FileReader();\n    let str;\n    let t = this;\n    fileReader.onload = function(event) {\n      //console.log(\"fileReader onload: \" + event);\n      //alert(\"onload\");\n      str = event.target.result;\n      pipe.init();\n      pipe.setCode(str);\n      //console.log(\"init get:\");\n      //console.log(pipe.getStageRegisters);\n      //pipe.stepi(1);\n\n      t.setState({ stageRegisters: pipe.getStageRegisters() });\n      t.setState({ stageRegisters: pipe.getRegisterFile() });\n\n      t.setState({ stageRegisters: pipe.getStageRegisters() });\n      t.setState({ registerFile: pipe.getRegisterFile() });\n      t.refreshCache();\n      t.setState({ stageIn: false });\n      setTimeout(() => {\n        t.setState({ stageIn: true });\n      }, 10);\n\n      let codeLines = [];\n      let line = \"\";\n      let i = 0;\n      while (i < str.length) {\n        if (str[i] != \"\\n\") {\n          if (str[i] == \" \") line += \"\\xa0\";\n          else line += str[i];\n        } else {\n          codeLines.push(line);\n          line = \"\";\n        }\n        i++;\n      }\n      t.setState({ code: codeLines });\n      //alert(pipe.Memory);\n    };\n    if (event.target.files.length) fileReader.readAsText(event.target.files[0]);\n  }\n  componentDidMount() {\n    // this.setState({ textHeight: this.textFieldDiv.clientHeight });\n    let t = this;\n    setTimeout(function f() {\n      t.setState({\n        colorL: t.state.colorL + colorDel,\n        colorR: t.state.colorR + colorDel\n      });\n      setTimeout(f, 20);\n    }, 20);\n  }\n\n  initCache() {\n    let newCache = pipe.getCache();\n    this.setState({ cache: newCache });\n  }\n  refreshCache() {\n    let newCache = pipe.getCache();\n    let oldCache = this.state.cache;\n    let newIn = [];\n    newIn.length = newCache.length;\n    for (let i = 0; i < newCache.length; i++) {\n      newIn[i] = [];\n      newIn[i].length = newCache[i].set.length;\n      for (let j = 0; j < newCache[i].set.length; j++) {\n        newIn[i][j] = [];\n        newIn[i][j].length = newCache[i].set[j].length;\n\n        for (let k = 0; k < newCache[i].set[j].length; k++) {\n          if (\n            !oldCache ||\n            i >= oldCache.length ||\n            !oldCache[i].set ||\n            j >= oldCache[i].set.length ||\n            !oldCache[i].set[j] ||\n            k >= oldCache[i].set[j].length ||\n            oldCache[i].set[j][k].tag != newCache[i].set[j][k].tag\n          )\n            newIn[i][j][k] = false;\n          else newIn[i][j][k] = true;\n          //newIn[i][j][k] = true;\n        }\n      }\n    }\n    console.log(\"new In\");\n    console.log(newIn);\n    this.setState({ cacheIn: newIn });\n    setTimeout(() => {\n      this.setState({ cache: newCache, cacheIn: undefined });\n    }, 500);\n  }\n  refreshStageRegisters(flag = 1) {\n    this.setState({ stageRegisters: pipe.getStageRegisters() });\n    this.setState({ registerFile: pipe.getRegisterFile() });\n    this.setState({\n      stageStuffs: pipe.getStageStuffs()\n    });\n    if (flag) {\n      this.setState({ stageIn: false });\n      setTimeout(() => {\n        this.setState({ stageIn: true });\n      }, 100);\n    }\n  }\n\n  /* run til breakpoint */\n  runPipe() {\n    let t = this;\n    let temp = colorDel;\n    colorDel = 10;\n    //t.setState({run:true});\n    setTimeout(function func() {\n      let stat = t.stepPipe(1, 0);\n      let PC = pipe.getPC();\n      if (!t.state.run || stat || breakPoints.has(PC)) {\n        t.toast(\"Stop at: 0x\" + PC);\n        if (t.state.run) {\n          t.setState({\n            fabIn: false\n          });\n        }\n        colorDel = temp;\n        t.refreshStageRegisters();\n        return;\n      }\n\n      setTimeout(func, runTimeout);\n    }, runTimeout);\n  }\n\n  stepPipe(i, flag = 1) {\n    let rtn = pipe.stepi(i);\n    switch (rtn) {\n      case 2:\n        this.toast(\"Address Error!\");\n        return rtn;\n      case 3:\n        this.toast(\"Instruction Invalid!\");\n        return rtn;\n      case 4:\n        this.toast(\"Halt!\");\n        return rtn;\n    }\n    this.refreshStageRegisters(flag);\n    this.refreshCache();\n    return rtn;\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { anchorEl } = this.state;\n\n    return (\n      <div className={classes.root}>\n        <CssBaseline />\n        <MuiThemeProvider theme={theme}>\n          <Drawer\n            open={this.state.drawerOpen}\n            onClose={() => {\n              this.setState({ drawerOpen: false });\n            }}\n          >\n            <MenuLayout parent={this} />\n            <div\n              tabIndex={0}\n              role=\"button\"\n              onClick={() => {\n                this.setState({ drawerOpen: false });\n              }}\n              onKeyDown={() => {\n                this.setState({ drawerOpen: false });\n              }}\n            />\n          </Drawer>\n          <AppBar\n            position=\"fixed\"\n            className={classes.appBar}\n            style={{\n              display: \"flex\",\n              alignContent: \"center\",\n              background:\n                \"linear-gradient(\" +\n                this.state.colorDeg +\n                \"deg, hsl(\" +\n                this.state.colorL +\n                \",50%,60%) 30%, hsl(\" +\n                this.state.colorR +\n                \",50%,60%)  90%)\"\n            }}\n          >\n            <Toolbar style={{ height: \"100%\" }}>\n              <IconButton\n                color=\"inherit\"\n                aria-label=\"Open drawer\"\n                onClick={() => {\n                  this.setState({ drawerOpen: true });\n                }}\n              >\n                <MenuIcon />\n              </IconButton>\n              <Tooltip title=\"Upload\" enterDelay={1000} leaveDelay={200}>\n                <IconButton\n                  color=\"inherit\"\n                  onClick={() => this.fileUpload.click()}\n                >\n                  <AddIcon />\n                </IconButton>\n              </Tooltip>\n              <input\n                type=\"file\"\n                accept=\".yo\"\n                ref={ref => (this.fileUpload = ref)}\n                style={{ visibility: \"hidden\" }}\n                onInput={this.handleUpload}\n              />\n\n              <Typography\n                variant=\"h6\"\n                color=\"inherit\"\n                noWrap\n                style={{ position: \"absolute\", right: 30 }}\n              >\n                {appBarTitle}\n              </Typography>\n            </Toolbar>\n\n            <div\n              style={{\n                position: \"fixed\",\n                height: 0,\n\n                hide: \"true\"\n              }}\n            >\n              <CacheLayout in={this.state.cacheIn} cache={this.state.cache} />\n            </div>\n          </AppBar>\n          {\n            //}toast\n          }\n\n          <Snackbar\n            key={0}\n            anchorOrigin={{\n              vertical: \"bottom\",\n              horizontal: \"left\"\n            }}\n            open={this.state.snackbarOpen}\n            autoHideDuration={1000}\n            onClose={() => {\n              this.setState({\n                snackbarOpen: false\n              });\n            }}\n            onExited={() => {\n              let msg = this.state.messageQueue;\n              msg.shift();\n              if (msg.length > 0) {\n                this.setState({\n                  messageQueue: msg,\n                  snackbarOpen: true\n                });\n              }\n            }}\n            ContentProps={{\n              \"aria-describedby\": \"message-id\"\n            }}\n            message={<span id=\"message-id\">{this.state.messageQueue[0]}</span>}\n          />\n\n          <main className={classes.content}>\n            <div>\n              <StageCards\n                stageRegisters={this.state.stageRegisters}\n                classes={classes}\n                hide={!this.state.run}\n              />\n            </div>\n\n            <div\n              style={{\n                width: \"100%\",\n                height: window.innerHeight - theme.spacing.unit * 20,\n\n                display: \"flex\",\n                alignItems: \"stretch\",\n                marginBottom: theme.spacing.unit * 3\n              }}\n            >\n              <div\n                style={{\n                  //flex: 1,\n                  //flexBasis:10000,\n                  marginRight: theme.spacing.unit * 3,\n                  width: \"60%\"\n                }}\n              >\n                <CodeLayout\n                  classes={classes}\n                  code={this.state.code}\n                  parent={this}\n                />\n              </div>\n\n              <div\n                style={{\n                  //flex:1,\n                  width: \"40%\"\n                }}\n              >\n                <StageRegistersLayout\n                  stageRegisters={this.state.stageRegisters}\n                  stageStuffs={this.state.stageStuffs}\n                  classes={classes}\n                  in={this.state.stageIn}\n                />\n              </div>\n            </div>\n            <div style={{ marginBottom: theme.spacing.unit * 3 }}>\n              <ExpansionPanel defaultExpanded={false} onMouseEnter={e => {}}>\n                <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                  <Typography>RegisterFile</Typography>\n                </ExpansionPanelSummary>\n                <ExpansionPanelDetails className={classes.details}>\n                  {\n                    //mention! add width:100% if wrapped by other labels }\n                  }\n                  <RegisterFileLayout classes={classes} />\n                </ExpansionPanelDetails>\n              </ExpansionPanel>\n            </div>\n          </main>\n          <div\n            style={{\n              zIndex: 1,\n              position: \"fixed\",\n              bottom: 0,\n              right: 0\n            }}\n          >\n            <TriTooltip title=\"Double Click to Run\">\n              <Zoom\n                in={this.state.fabIn}\n                onEntered={() => {\n                  this.setState({\n                    onFabTransit: false\n                  });\n                  if (this.state.run) {\n                    this.runPipe();\n                  }\n                }}\n                onExit={() => {\n                  this.setState({\n                    onFabTransit: true\n                  });\n                }}\n                onExited={() => {\n                  this.setState({\n                    fabIn: true,\n                    run: !this.state.run\n                  });\n                }}\n              >\n                <Fab\n                  color=\"secondary\"\n                  style={{ margin: theme.spacing.unit * 3 }}\n                >\n                  {this.state.run ? (\n                    <PauseIcon\n                      onClick={() => {\n                        //this.toast(\"stepi\");\n                        this.setState({\n                          fabIn: false\n                        });\n                        //this.refreshStageRegisters();\n                      }}\n                    />\n                  ) : (\n                    <ChevronRightIcon\n                      onClick={() => {\n                        //this.toast(\"stepi\");\n                        this.stepPipe(1);\n                      }}\n                      onDoubleClick={() => {\n                        if (this.state.onFabTransit) {\n                          return;\n                        }\n                        this.toast(\"Run\");\n                        this.setState({\n                          fabIn: false\n                        });\n                      }}\n                    />\n                  )}\n                </Fab>\n              </Zoom>\n            </TriTooltip>\n          </div>\n        </MuiThemeProvider>\n      </div>\n    );\n  }\n}\nclass TriTooltip extends React.Component {\n  state = {\n    open: false,\n    cnt: 3\n  };\n  render() {\n    const props = this.props;\n    return (\n      <Tooltip\n        title={this.props.title}\n        enterDelay={500}\n        leaveDelay={200}\n        onOpen={() => {\n          if (!this.state.cnt) return;\n          this.setState({ cnt: this.state.cnt - 1 });\n          this.setState({ open: true });\n        }}\n        onClose={() => {\n          this.setState({ open: false });\n        }}\n        open={this.state.open}\n        enterDelay={500}\n        leaveDelay={200}\n      >\n        {props.children}\n      </Tooltip>\n    );\n  }\n}\n\nMainLayout.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nexport default withStyles(styles)(MainLayout);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Layout from \"./layout\";\n\nconst rootElement = document.getElementById(\"root\");\n\nReactDOM.render(<Layout />, rootElement);\n"],"sourceRoot":""}